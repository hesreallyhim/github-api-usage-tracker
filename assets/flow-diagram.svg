<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 900 280">
  <defs>
    <!-- Refined gradients -->
    <linearGradient id="bgGrad" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#0d1117"/>
      <stop offset="50%" style="stop-color:#161b22"/>
      <stop offset="100%" style="stop-color:#0d1117"/>
    </linearGradient>

    <linearGradient id="cardGrad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#21262d"/>
      <stop offset="100%" style="stop-color:#161b22"/>
    </linearGradient>

    <linearGradient id="blueGlow" x1="0%" y1="0%" x2="100%" y2="0%">
      <stop offset="0%" style="stop-color:#1f6feb;stop-opacity:0"/>
      <stop offset="50%" style="stop-color:#58a6ff;stop-opacity:1"/>
      <stop offset="100%" style="stop-color:#1f6feb;stop-opacity:0"/>
    </linearGradient>

    <linearGradient id="flowLine" x1="0%" y1="0%" x2="100%" y2="0%">
      <stop offset="0%" style="stop-color:#238636"/>
      <stop offset="50%" style="stop-color:#58a6ff"/>
      <stop offset="100%" style="stop-color:#a371f7"/>
    </linearGradient>

    <linearGradient id="preGrad" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#238636"/>
      <stop offset="100%" style="stop-color:#2ea043"/>
    </linearGradient>

    <linearGradient id="execGrad" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#1f6feb"/>
      <stop offset="100%" style="stop-color:#58a6ff"/>
    </linearGradient>

    <linearGradient id="postGrad" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#8957e5"/>
      <stop offset="100%" style="stop-color:#a371f7"/>
    </linearGradient>

    <!-- Subtle noise texture -->
    <filter id="noise" x="0%" y="0%" width="100%" height="100%">
      <feTurbulence type="fractalNoise" baseFrequency="0.9" numOctaves="4" result="noise"/>
      <feColorMatrix type="saturate" values="0"/>
      <feBlend in="SourceGraphic" in2="noise" mode="multiply" result="blend"/>
      <feComposite in="blend" in2="SourceGraphic" operator="in"/>
    </filter>

    <!-- Glow effects -->
    <filter id="glow" x="-50%" y="-50%" width="200%" height="200%">
      <feGaussianBlur stdDeviation="3" result="coloredBlur"/>
      <feMerge>
        <feMergeNode in="coloredBlur"/>
        <feMergeNode in="SourceGraphic"/>
      </feMerge>
    </filter>

    <filter id="softGlow" x="-50%" y="-50%" width="200%" height="200%">
      <feGaussianBlur stdDeviation="8" result="blur"/>
      <feMerge>
        <feMergeNode in="blur"/>
        <feMergeNode in="SourceGraphic"/>
      </feMerge>
    </filter>

    <!-- Card shadow -->
    <filter id="cardShadow" x="-20%" y="-20%" width="140%" height="140%">
      <feDropShadow dx="0" dy="4" stdDeviation="6" flood-color="#000" flood-opacity="0.4"/>
    </filter>

    <!-- Dot pattern -->
    <pattern id="dots" x="0" y="0" width="20" height="20" patternUnits="userSpaceOnUse">
      <circle cx="2" cy="2" r="0.5" fill="#30363d" opacity="0.5"/>
    </pattern>

    <!-- Flow particle -->
    <circle id="particle" r="3" fill="#58a6ff">
      <animate attributeName="opacity" values="0.3;1;0.3" dur="2s" repeatCount="indefinite"/>
    </circle>

    <!-- Animated dash pattern -->
    <linearGradient id="dashGrad" x1="0%" y1="0%" x2="100%" y2="0%">
      <stop offset="0%" style="stop-color:#30363d"/>
      <stop offset="50%" style="stop-color:#58a6ff"/>
      <stop offset="100%" style="stop-color:#30363d"/>
    </linearGradient>
  </defs>

  <!-- Background with texture -->
  <rect width="900" height="280" fill="url(#bgGrad)" rx="12"/>
  <rect width="900" height="280" fill="url(#dots)" rx="12" opacity="0.6"/>

  <!-- Subtle grid lines -->
  <g opacity="0.1" stroke="#30363d" stroke-width="0.5">
    <line x1="0" y1="70" x2="900" y2="70"/>
    <line x1="0" y1="140" x2="900" y2="140"/>
    <line x1="0" y1="210" x2="900" y2="210"/>
  </g>

  <!-- Main flow connection line (background) -->
  <path d="M 160 140 Q 300 140 340 140 L 560 140 Q 600 140 740 140"
        stroke="#21262d" stroke-width="4" fill="none" stroke-linecap="round"/>

  <!-- Animated flow line -->
  <path d="M 160 140 Q 300 140 340 140 L 560 140 Q 600 140 740 140"
        stroke="url(#flowLine)" stroke-width="2" fill="none" stroke-linecap="round"
        stroke-dasharray="8,12" opacity="0.8">
    <animate attributeName="stroke-dashoffset" from="0" to="-40" dur="1.5s" repeatCount="indefinite"/>
  </path>

  <!-- Flowing particles along path -->
  <g filter="url(#glow)">
    <circle r="4" fill="#58a6ff">
      <animateMotion dur="3s" repeatCount="indefinite">
        <mpath href="#flowPath"/>
      </animateMotion>
      <animate attributeName="opacity" values="0;1;1;0" dur="3s" repeatCount="indefinite"/>
    </circle>
    <circle r="4" fill="#2ea043">
      <animateMotion dur="3s" repeatCount="indefinite" begin="1s">
        <mpath href="#flowPath"/>
      </animateMotion>
      <animate attributeName="opacity" values="0;1;1;0" dur="3s" repeatCount="indefinite" begin="1s"/>
    </circle>
    <circle r="4" fill="#a371f7">
      <animateMotion dur="3s" repeatCount="indefinite" begin="2s">
        <mpath href="#flowPath"/>
      </animateMotion>
      <animate attributeName="opacity" values="0;1;1;0" dur="3s" repeatCount="indefinite" begin="2s"/>
    </circle>
  </g>
  <path id="flowPath" d="M 160 140 L 740 140" fill="none"/>

  <!-- === PRE-HOOK CARD === -->
  <g filter="url(#cardShadow)">
    <rect x="40" y="70" width="140" height="140" rx="12" fill="url(#cardGrad)" stroke="#30363d" stroke-width="1"/>

    <!-- Card inner glow -->
    <rect x="41" y="71" width="138" height="20" rx="11" fill="#238636" opacity="0.15"/>

    <!-- Icon: Capture/Camera -->
    <g transform="translate(110, 115)">
      <circle r="24" fill="none" stroke="url(#preGrad)" stroke-width="2" opacity="0.3"/>
      <circle r="18" fill="#238636" opacity="0.2"/>
      <circle r="12" fill="url(#preGrad)" filter="url(#glow)">
        <animate attributeName="r" values="12;14;12" dur="2s" repeatCount="indefinite"/>
      </circle>
      <!-- Radar sweep -->
      <g>
        <path d="M 0 0 L 0 -12 A 12 12 0 0 1 10.4 6 Z" fill="#2ea043" opacity="0.6">
          <animateTransform attributeName="transform" type="rotate" from="0" to="360" dur="2s" repeatCount="indefinite"/>
        </path>
      </g>
    </g>

    <!-- Label -->
    <text x="110" y="170" text-anchor="middle" fill="#7ee787" font-family="system-ui, -apple-system, sans-serif" font-size="11" font-weight="600">CAPTURE</text>
    <text x="110" y="185" text-anchor="middle" fill="#8b949e" font-family="system-ui, -apple-system, sans-serif" font-size="9">Rate Limits</text>
  </g>

  <!-- === EXECUTION CARD (Center, larger) === -->
  <g filter="url(#cardShadow)">
    <rect x="290" y="55" width="320" height="170" rx="12" fill="url(#cardGrad)" stroke="#30363d" stroke-width="1"/>

    <!-- Card header accent -->
    <rect x="291" y="56" width="318" height="24" rx="11" fill="#1f6feb" opacity="0.1"/>

    <!-- GitHub Actions icon -->
    <g transform="translate(330, 100)">
      <circle r="16" fill="#1f6feb" opacity="0.2"/>
      <path d="M -6 -6 L 6 -6 L 6 6 L -6 6 Z" fill="none" stroke="url(#execGrad)" stroke-width="2" stroke-linecap="round">
        <animateTransform attributeName="transform" type="rotate" from="0" to="360" dur="8s" repeatCount="indefinite"/>
      </path>
      <circle r="4" fill="#58a6ff" filter="url(#glow)">
        <animate attributeName="r" values="3;5;3" dur="1.5s" repeatCount="indefinite"/>
      </circle>
    </g>

    <!-- Workflow text -->
    <text x="360" y="105" fill="#58a6ff" font-family="system-ui, -apple-system, sans-serif" font-size="12" font-weight="600">WORKFLOW EXECUTION</text>

    <!-- API Bucket indicators -->
    <g transform="translate(310, 140)">
      <!-- Core API -->
      <g>
        <rect x="0" y="0" width="80" height="55" rx="6" fill="#21262d" stroke="#30363d" stroke-width="1"/>
        <text x="40" y="18" text-anchor="middle" fill="#8b949e" font-family="monospace" font-size="8">CORE</text>
        <rect x="10" y="26" width="60" height="6" rx="3" fill="#161b22"/>
        <rect x="10" y="26" width="45" height="6" rx="3" fill="#238636" opacity="0.8">
          <animate attributeName="width" values="20;45;35;45" dur="4s" repeatCount="indefinite"/>
        </rect>
        <text x="40" y="46" text-anchor="middle" fill="#7ee787" font-family="monospace" font-size="9">4,955</text>
      </g>

      <!-- GraphQL API -->
      <g transform="translate(90, 0)">
        <rect x="0" y="0" width="80" height="55" rx="6" fill="#21262d" stroke="#30363d" stroke-width="1"/>
        <text x="40" y="18" text-anchor="middle" fill="#8b949e" font-family="monospace" font-size="8">GRAPHQL</text>
        <rect x="10" y="26" width="60" height="6" rx="3" fill="#161b22"/>
        <rect x="10" y="26" width="50" height="6" rx="3" fill="#1f6feb" opacity="0.8">
          <animate attributeName="width" values="30;50;40;50" dur="3.5s" repeatCount="indefinite"/>
        </rect>
        <text x="40" y="46" text-anchor="middle" fill="#58a6ff" font-family="monospace" font-size="9">4,990</text>
      </g>

      <!-- Search API -->
      <g transform="translate(180, 0)">
        <rect x="0" y="0" width="80" height="55" rx="6" fill="#21262d" stroke="#30363d" stroke-width="1"/>
        <text x="40" y="18" text-anchor="middle" fill="#8b949e" font-family="monospace" font-size="8">SEARCH</text>
        <rect x="10" y="26" width="60" height="6" rx="3" fill="#161b22"/>
        <rect x="10" y="26" width="35" height="6" rx="3" fill="#8957e5" opacity="0.8">
          <animate attributeName="width" values="15;35;25;35" dur="5s" repeatCount="indefinite"/>
        </rect>
        <text x="40" y="46" text-anchor="middle" fill="#a371f7" font-family="monospace" font-size="9">25</text>
      </g>
    </g>
  </g>

  <!-- === POST-HOOK CARD === -->
  <g filter="url(#cardShadow)">
    <rect x="720" y="70" width="140" height="140" rx="12" fill="url(#cardGrad)" stroke="#30363d" stroke-width="1"/>

    <!-- Card inner glow -->
    <rect x="721" y="71" width="138" height="20" rx="11" fill="#8957e5" opacity="0.15"/>

    <!-- Icon: Output/Export -->
    <g transform="translate(790, 115)">
      <circle r="24" fill="none" stroke="url(#postGrad)" stroke-width="2" opacity="0.3"/>

      <!-- Pulsing rings -->
      <circle r="18" fill="none" stroke="#a371f7" stroke-width="1" opacity="0.4">
        <animate attributeName="r" values="12;22;12" dur="2s" repeatCount="indefinite"/>
        <animate attributeName="opacity" values="0.6;0;0.6" dur="2s" repeatCount="indefinite"/>
      </circle>

      <!-- JSON bracket icon -->
      <g fill="none" stroke="#a371f7" stroke-width="2" stroke-linecap="round" filter="url(#glow)">
        <path d="M -6 -8 L -10 -8 Q -14 -8 -14 -4 L -14 4 Q -14 8 -10 8 L -6 8"/>
        <path d="M 6 -8 L 10 -8 Q 14 -8 14 -4 L 14 4 Q 14 8 10 8 L 6 8"/>
      </g>
      <circle r="3" fill="#a371f7">
        <animate attributeName="opacity" values="0.5;1;0.5" dur="1s" repeatCount="indefinite"/>
      </circle>
    </g>

    <!-- Label -->
    <text x="790" y="170" text-anchor="middle" fill="#a371f7" font-family="system-ui, -apple-system, sans-serif" font-size="11" font-weight="600">OUTPUT</text>
    <text x="790" y="185" text-anchor="middle" fill="#8b949e" font-family="system-ui, -apple-system, sans-serif" font-size="9">Usage JSON</text>
  </g>

  <!-- Flow arrows -->
  <g fill="#58a6ff" filter="url(#glow)">
    <!-- Arrow 1 -->
    <polygon points="212,140 200,134 200,146" opacity="0.8">
      <animate attributeName="opacity" values="0.4;1;0.4" dur="1.5s" repeatCount="indefinite"/>
    </polygon>
    <!-- Arrow 2 -->
    <polygon points="272,140 260,134 260,146" opacity="0.8">
      <animate attributeName="opacity" values="0.4;1;0.4" dur="1.5s" repeatCount="indefinite" begin="0.3s"/>
    </polygon>
    <!-- Arrow 3 -->
    <polygon points="642,140 630,134 630,146" opacity="0.8">
      <animate attributeName="opacity" values="0.4;1;0.4" dur="1.5s" repeatCount="indefinite" begin="0.6s"/>
    </polygon>
    <!-- Arrow 4 -->
    <polygon points="697,140 685,134 685,146" opacity="0.8">
      <animate attributeName="opacity" values="0.4;1;0.4" dur="1.5s" repeatCount="indefinite" begin="0.9s"/>
    </polygon>
  </g>

  <!-- Top labels -->
  <text x="110" y="45" text-anchor="middle" fill="#484f58" font-family="system-ui, -apple-system, sans-serif" font-size="10" letter-spacing="2">PRE-HOOK</text>
  <text x="450" y="45" text-anchor="middle" fill="#484f58" font-family="system-ui, -apple-system, sans-serif" font-size="10" letter-spacing="2">YOUR ACTIONS RUN</text>
  <text x="790" y="45" text-anchor="middle" fill="#484f58" font-family="system-ui, -apple-system, sans-serif" font-size="10" letter-spacing="2">POST-HOOK</text>

  <!-- Bottom info bar -->
  <g transform="translate(0, 240)">
    <rect x="40" y="0" width="820" height="28" rx="6" fill="#161b22" stroke="#21262d" stroke-width="1"/>
    <text x="60" y="18" fill="#8b949e" font-family="monospace" font-size="10">
      <tspan fill="#7ee787">remaining:</tspan> 4987
      <tspan fill="#484f58">â†’</tspan>
      <tspan fill="#f0883e">remaining:</tspan> 4942
      <tspan fill="#484f58">=</tspan>
      <tspan fill="#58a6ff">{ "core": 45, "graphql": 10, "search": 5 }</tspan>
    </text>
  </g>

  <!-- Ambient glow spots -->
  <circle cx="110" cy="115" r="60" fill="#238636" opacity="0.03" filter="url(#softGlow)"/>
  <circle cx="450" cy="140" r="100" fill="#1f6feb" opacity="0.03" filter="url(#softGlow)"/>
  <circle cx="790" cy="115" r="60" fill="#8957e5" opacity="0.03" filter="url(#softGlow)"/>
</svg>
